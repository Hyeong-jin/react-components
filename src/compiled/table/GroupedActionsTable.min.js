define(function(a){"use strict";var b=a("drc/table/BaseTable"),c=a("lodash"),d=(a("moment"),a("react")),e=a("drc/utils/Utils"),f={clobberBaseTable:{getTableRowItem:function(a,b){var f=[],g=[];return c.forIn(this.state.colDefinitions,function(c){g.push(this.getTableData(a,c,b))}.bind(this)),f.push(d.createElement("tr",{"data-index":b,key:"tableRow"+e.guid(),className:"hover-enabled text-select",onClick:this.handleGroupRowClick},g)),this.state.selectedIndex===b&&c.each(a.actions,function(a){var b=[];c.forIn(this.state.colDefinitions,function(c){b.push(this.getNestedRowTableData(a,c))}.bind(this)),f.push(d.createElement("tr",{"data-flowid":a.flowID,key:"tableRow"+e.guid(),className:"hover-enabled text-select sub-action",onClick:this.handleRowClick},b))},this),f},getTableData:function(a,b,c){var f,g,h,i=a[b.dataProperty],j=d.addons.classSet({content:!0,"group-date":"groupDate"===b.dataProperty});return"duration"===b.dataProperty?i=this.calculateDurationString(i):"groupDate"===b.dataProperty&&(g=this.state.selectedIndex===c?this.iconClasses.rowsExpanded:this.iconClasses.rowsCollapsed,h=d.addons.classSet({"before-icon":!0,"expanded-row-indicator":!0,inactive:this.state.selectedIndex!==c}),f=d.createElement("span",{className:h},a.actions.length,d.createElement("i",{className:g}))),d.createElement("td",{key:"tableData"+e.guid()},f,d.createElement("span",{className:j,title:i},i))}},addToBaseTable:{componentDidUpdate:function(){this.state.selectedIndex>-1&&$("tr.sub-action").find("td").wrapInner('<div class="wrap-inner" />').parent().show().find("td > div").slideDown(200,function(){var a=$(this);a.replaceWith(a.contents())})},getNestedRowTableData:function(a,b){var c="--",f=d.addons.classSet({content:!0,"nested-text":"groupDate"===b.dataProperty});if(a.start&&a.end){switch(b.dataProperty){case"groupDate":c=e.calculateTimeString(a.start,a.end);break;case"duration":c=this.calculateDurationString(new Date(a.end).getTime()-new Date(a.start).getTime());break;case"totalCount":c=a.actionCount}return d.createElement("td",{key:"tableData"+e.guid()},d.createElement("span",{className:f,title:c},c))}},calculateDurationString:function(a){return String(Math.max(1,Math.ceil(a/60/1e3)))+"m"},handleGroupRowClick:function(a){var b=$(a.currentTarget).data("index");this.setState({selectedIndex:this.state.selectedIndex===b?-1:b})}}};return e.extendReactClass(b,f.clobberBaseTable,f.addToBaseTable)});